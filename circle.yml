machine:
  services:
    - docker
  post:
    - pyenv global 2.7.11 3.6.1

dependencies:
  pre:
    - docker build -t sdk_test_server .
    - git clone -b dockerise https://${GITHUB_TOKEN:-git}@github.com/ARMmbed/mbed-cloud-sdk-testrunner.git testrunner
    - docker build -t testrunner testrunner
    #- sudo apt-get update; sudo apt-get install pandoc


test:
  override:
    - flake8 --config ./.flake8
    - ./tests/run.sh

deployment:
  production:
    branch: master
    commands:
      - ./generate-docs.sh
